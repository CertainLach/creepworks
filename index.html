<html>
<title>CreepWorks DeObfuscator</title>
<body>
<h1>CreepWorks DeObfuscator v0.1</h1>
<script language='javascript'>
function deobfuscate() {
	  var d1 = document.getElementById( "d1c" ).checked;
	  var d2 = document.getElementById( "d2c" ).checked;
      document.deob.log.value = 'Started deobfuscation';
      var v = document.deob.escaped.value;
      //v = v.replace(';', ';\n');
      t = v.split(' ')[1].split('=')[0];
      document.deob.log.value = document.deob.log.value + '\n Got obfuscation variable: ' + t;
      v = v.replace(new RegExp(t, 'g'), 'encoded');
      document.deob.log.value = document.deob.log.value + '\n Replaced';
      var m = new Array();
      var m = v.split(';');
      eval(m[0]);
      document.deob.dictionary.value = encoded.join(' \n');
      document.deob.log.value = document.deob.log.value + '\n Got deobfuscation dictionary';
      decoded = document.deob.dictionary.value.split(' \n');
      deobflength = decoded.length;
      document.deob.log.value = document.deob.log.value + '\n Total words: ' + deobflength;
      document.deob.dictionary.value = '';
      for (var i = 0; i < decoded.length; i++) {
          document.deob.dictionary.value = document.deob.dictionary.value + i + ': ' + decoded[i] + '\n';
      };
      document.deob.log.value = document.deob.log.value + '\n Formatted deobfuscation dictionary';
      if(d1) 
      	m[0] = '//Deobfuscated by CreepWorks DeObfuscator';
      v = m.join(';');

      if(d1){
      	count = 0;
      for (i = 0; i < decoded.length; i++) {
          var s = 'encoded[' + i + ']';
          while (v.indexOf(s) >= 0) {
              v = v.replace(s, '"' + decoded[i] + '"');
              count++;
          }
      }
      document.deob.log.value = document.deob.log.value + '\n Processing 1: Decoded total ' + count + ' strings';
      }
      m = new Array();
      m = v.split(';');
      oc = count;
      count = 0;
      
      if (d2){
      for (i = 0; i < m.length; i++) {
          var t1 = '"]["';
          var t2 = '"]';
          var t3 = '["';
          var t4 = '"](';
          var jjj = oc + deobflength;
          while (jjj >= 0) {
              m[i] = m[i].replace(t1, '.').replace(t2, '').replace(t3, '.').replace(t4, '(');
              count++;
              jjj--;
          }
      }
      document.deob.log.value = document.deob.log.value + '\n Processing 2: Decoded total ' + count + ' strings';}
      v = m.join(';').replace('//Deobfuscated by CreepWorks DeObfuscator;','//Deobfuscated by CreepWorks DeObfuscator\n')
      document.deob.unescaped.value = v;
      document.deob.log.value = document.deob.log.value + '\nDeobfuscated';
  }
</script>
<form name='deob' id='deob'>
<table border='0'>
<tr><td valign='top'>Obfuscated:</td>
<td><textarea name='escaped' id='escaped' rows='10' cols='70'>
var _0x2135=["\x53\x61\x79\x48\x65\x6C\x6C\x6F","\x47\x65\x74\x43\x6F\x75\x6E\x74","\x4D\x65\x73\x73\x61\x67\x65\x20\x3A\x20","\x59\x6F\x75\x20\x61\x72\x65\x20\x77\x65\x6C\x63\x6F\x6D\x65\x2E"];function NewObject(_0x28ffx2){var _0x28ffx3=0;this[_0x2135[0]]=function(_0x28ffx4){_0x28ffx3++;alert(_0x28ffx2+_0x28ffx4);};this[_0x2135[1]]=function(){return _0x28ffx3};}var obj= new NewObject(_0x2135[2]);obj.SayHello(_0x2135[3]);
</textarea></td>
</tr>
<tr><td>Click here:</td>
<td><input type='button' name='cmdDoIt' id='cmdDoIt' value='Deobfuscate!' onclick='deobfuscate()'>
<input type="checkbox" id="d1c" checked="checked"/>
<label for="d2">Decode values (Work)</label>
<input type="checkbox" id="d2c"/>
<label for="d1">Decode operands (Unstable)</label>
</td>
</tr>
<tr><td valign='top'>Log:</td>
<td><textarea name='log' id='log' rows='10' cols='70'></textarea></td>
</tr>
<tr><td valign='top'>Deobfuscated:</td>
<td><textarea name='unescaped' id='unescaped' rows='10' cols='70'></textarea></td>
</tr>
<tr><td valign='top'>Dictionary:</td>
<td><textarea name='dictionary' id='dictionary' rows='10' cols='70'></textarea></td>
</tr>
</table>
</form>
</body>
</html>